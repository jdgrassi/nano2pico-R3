#!/bin/env python
import os, argparse
import ROOT

def get_2d_mass_points(signal_chain, pdgId_1, pdgId_2):
  signal_chain.SetEstimate(signal_chain.GetEntries()+1)
  signal_chain.Draw("MinIf$(GenPart_mass,GenPart_pdgId=="+str(pdgId_1)+"):MinIf$(GenPart_mass,GenPart_pdgId=="+str(pdgId_2)+")","", "goff")
  number_variables = signal_chain.GetSelectedRows()
  mass_array_1 = signal_chain.GetV1()
  mass_array_2 = signal_chain.GetV2()
  mass_points = set()
  #print(number_variables, signal_chain.GetEntries())
  for iVar in range(number_variables):
    #print (mass_array_1[iVar], mass_array_2[iVar])
    if (mass_array_1[iVar] == 127):
      mass_points.add((mass_array_1[iVar], int(round(mass_array_2[iVar]/25)*25)))
    else:
      mass_points.add((int(round(mass_array_1[iVar]/25)*25), int(round(mass_array_2[iVar]/25)*25)))
  return sorted(mass_points)

if __name__ == '__main__':
  parser = argparse.ArgumentParser(description="Find mass points",
                                   formatter_class=argparse.ArgumentDefaultsHelpFormatter)
  parser.add_argument("-i","--in_dir", default="/mnt/hadoop/pico/NanoAODv5/nano/2016/TChiHH_unsplit/",
                      help="Directory where the unsplit NanoAOD files are")
  parser.add_argument("-f","--filenames", default="*.root",
                      help="Files to find mass points")
  args = parser.parse_args()

  chain = ROOT.TChain('Events')
  print(args.in_dir+"/"+args.dataset_filenames)
  chain.Add(args.in_dir+"/"+args.dataset_filenames)
  # mass_points = [(NLSP, LSP)]
  mass_points = get_2d_mass_points(chain, 1000023, 1000022)
  for mass_point in mass_points:

  mass_points = [(150, 25), (175, 25), (175, 50), (200, 25), (200, 50), (200, 75), (225, 50), (225, 75), (225, 100), (250, 50), (250, 75), (250, 100), (250, 125), (275, 100), (275, 125), (275, 150), (300, 50), (300, 100), (300, 125), (300, 150), (300, 175), (325, 150), (325, 175), (325, 200), (350, 50), (350, 100), (350, 150), (350, 175), (350, 200), (350, 225), (375, 200), (375, 225), (375, 250), (400, 50), (400, 100), (400, 150), (400, 200), (400, 225), (400, 250), (400, 275), (425, 250), (425, 275), (425, 300), (450, 50), (450, 100), (450, 150), (450, 200), (450, 250), (450, 275), (450, 300), (450, 325), (475, 300), (475, 325), (475, 350), (500, 50), (500, 100), (500, 150), (500, 200), (500, 250), (500, 300), (500, 325), (500, 350), (500, 375), (525, 350), (525, 375), (525, 400), (550, 50), (550, 100), (550, 150), (550, 200), (550, 250), (550, 300), (550, 350), (550, 375), (550, 400), (550, 425), (575, 400), (575, 425), (575, 450), (600, 50), (600, 100), (600, 150), (600, 200), (600, 250), (600, 300), (600, 350), (600, 400), (600, 425), (600, 450), (600, 475), (625, 450), (625, 475), (625, 500), (650, 50), (650, 100), (650, 150), (650, 200), (650, 250), (650, 300), (650, 350), (650, 400), (650, 450), (650, 475), (650, 500), (650, 525), (675, 500), (675, 525), (675, 550), (700, 50), (700, 100), (700, 150), (700, 200), (700, 250), (700, 300), (700, 350), (700, 400), (700, 450), (700, 500), (700, 525), (700, 550), (700, 575), (725, 550), (725, 575), (725, 600), (750, 50), (750, 100), (750, 150), (750, 200), (750, 250), (750, 300), (750, 350), (750, 400), (750, 450), (750, 500), (750, 550), (750, 575), (750, 600), (750, 625), (775, 600), (775, 625), (775, 650), (800, 50), (800, 100), (800, 150), (800, 200), (800, 250), (800, 300), (800, 350), (800, 400), (800, 450), (800, 500), (800, 550), (800, 600), (800, 625), (800, 650), (800, 675), (825, 650), (825, 675), (825, 700), (850, 50), (850, 100), (850, 150), (850, 200), (850, 250), (850, 300), (850, 350), (850, 400), (850, 450), (850, 500), (850, 550), (850, 600), (850, 650), (850, 675), (850, 700), (850, 725), (875, 700), (875, 725), (875, 750), (900, 50), (900, 100), (900, 150), (900, 200), (900, 250), (900, 300), (900, 350), (900, 400), (900, 450), (900, 500), (900, 550), (900, 600), (900, 650), (900, 700), (900, 725), (900, 750), (900, 775), (925, 750), (925, 775), (925, 800), (950, 50), (950, 100), (950, 150), (950, 200), (950, 250), (950, 300), (950, 350), (950, 400), (950, 450), (950, 500), (950, 550), (950, 600), (950, 650), (950, 700), (950, 750), (950, 775), (950, 800), (950, 825), (975, 800), (975, 825), (975, 850), (1000, 50), (1000, 100), (1000, 150), (1000, 200), (1000, 250), (1000, 300), (1000, 350), (1000, 400), (1000, 450), (1000, 500), (1000, 550), (1000, 600), (1000, 650), (1000, 700), (1000, 750), (1000, 800), (1000, 825), (1000, 850), (1000, 875), (1025, 850), (1025, 875), (1025, 900), (1050, 50), (1050, 100), (1050, 150), (1050, 200), (1050, 250), (1050, 300), (1050, 350), (1050, 400), (1050, 450), (1050, 500), (1050, 550), (1050, 600), (1050, 650), (1050, 700), (1050, 750), (1050, 800), (1050, 850), (1050, 875), (1050, 900), (1050, 925), (1075, 900), (1075, 925), (1075, 950), (1100, 50), (1100, 100), (1100, 150), (1100, 200), (1100, 250), (1100, 300), (1100, 350), (1100, 400), (1100, 450), (1100, 500), (1100, 550), (1100, 600), (1100, 650), (1100, 700), (1100, 750), (1100, 800), (1100, 850), (1100, 900), (1100, 925), (1100, 950), (1100, 975), (1125, 950), (1125, 975), (1125, 1000), (1150, 50), (1150, 100), (1150, 150), (1150, 200), (1150, 250), (1150, 300), (1150, 350), (1150, 400), (1150, 450), (1150, 500), (1150, 550), (1150, 600), (1150, 650), (1150, 700), (1150, 750), (1150, 800), (1150, 850), (1150, 900), (1150, 950), (1150, 975), (1150, 1000), (1150, 1025), (1175, 1000), (1175, 1025), (1175, 1050), (1200, 50), (1200, 100), (1200, 150), (1200, 200), (1200, 250), (1200, 300), (1200, 350), (1200, 400), (1200, 450), (1200, 500), (1200, 550), (1200, 600), (1200, 650), (1200, 700), (1200, 750), (1200, 800), (1200, 850), (1200, 900), (1200, 950), (1200, 1000), (1200, 1025), (1200, 1050), (1200, 1075)]
